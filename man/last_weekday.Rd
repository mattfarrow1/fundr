% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/date_utils.R
\name{last_weekday}
\alias{last_weekday}
\title{Find most recent occurrence of a weekday}
\usage{
last_weekday(weekday, as_of = Sys.Date(), include_today = TRUE)
}
\arguments{
\item{weekday}{Day of week: name (e.g., "Friday", "fri"), or number
(1 = Sunday through 7 = Saturday, following R's convention).}

\item{as_of}{Reference date. Default is today.}

\item{include_today}{Logical. If TRUE (default) and \code{as_of} falls on
the target weekday, returns \code{as_of}. If FALSE, returns the previous
occurrence.}
}
\value{
Date of the most recent occurrence of the specified weekday.
}
\description{
Returns the most recent date that falls on a specific day of the week.
Useful for finding dates like "last Friday" for file naming when
databases refresh on specific days.
}
\examples{
# Find last Friday
last_weekday("Friday")

# Using abbreviation
last_weekday("fri")

# Using number (6 = Friday)
last_weekday(6)

# From a specific date
last_weekday("Friday", as_of = as.Date("2024-06-15"))
#> "2024-06-14"

# Exclude today even if it matches
last_weekday("Friday", as_of = as.Date("2024-06-14"),
             include_today = FALSE)
#> "2024-06-07"

}
